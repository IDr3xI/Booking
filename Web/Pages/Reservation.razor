@page "/reservation"

<h3 class="text-xl font-semibold mb-3">Zabookovat místo</h3>

<select @bind="selectedRoomId" class="p-2 border rounded">
    @foreach (var room in Rooms)
    {
        <option value="@room.Id">@room.Name</option>
    }
</select>

<div class="mt-4 grid grid-cols-2 gap-4">
    @foreach (var seat in SelectedRoom?.Seats ?? Enumerable.Empty<Seat>())
    {
        <div class="p-4 border rounded text-center cursor-pointer"
             style="background:@(seat.IsBooked ? "#fca5a5" : "#bbf7d0")"
             @onclick="() => ToggleBooking(seat)">
            <b>@seat.Code</b>
            <div>@(seat.IsBooked ? "Obsazeno" : "Volné")</div>
        </div>
    }
</div>

@code {
    record Seat(int Id, string Code, bool IsBooked);
    record Room(int Id, string Name, List<Seat> Seats);

    List<Room> Rooms = new()
    {
        new(1, "Red Zone", new() { new(1, "RZ-01", false), new(2, "RZ-02", true) }),
        new(2, "Blue Zone", new() { new(3, "BZ-01", false), new(4, "BZ-02", false) }),
        new(3, "Green Zone", new() { new(5, "GZ-01", true), new(6, "GZ-02", false) })
    };

    int selectedRoomId = 1;

    Room? SelectedRoom => Rooms.FirstOrDefault(r => r.Id == selectedRoomId);

    void ToggleBooking(Seat seat)
    {
        if (seat.IsBooked)
        {
            // Simulace zrušení rezervace
            seat = seat with { IsBooked = false };
        }
        else
        {
            // Simulace vytvoření rezervace
            seat = seat with { IsBooked = true };
        }
    }
}
